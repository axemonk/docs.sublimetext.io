import{_ as t,E as o,c as l,m as s,a as e,J as a,a4 as n,o as r}from"./chunks/framework.DTvtauHd.js";const w=JSON.parse('{"title":"Plugins","description":"","frontmatter":{"title":"Plugins"},"headers":[],"relativePath":"guide/extensibility/plugins/index.md","filePath":"guide/extensibility/plugins/index.md","lastUpdated":1714902754000}'),h={name:"guide/extensibility/plugins/index.md"},d=n('<h1 id="plugins" tabindex="-1">Plugins <a class="header-anchor" href="#plugins" aria-label="Permalink to &quot;Plugins&quot;">​</a></h1><div class="info custom-block"><p class="custom-block-title">INFO</p><p><a href="/reference/python_api.html">API Reference</a> : More information on the Python API.</p><p><a href="/reference/plugins.html">Plugins Reference</a> : More information about plugins.</p></div><p>This section is intended for users with programming skills.</p><p>Sublime Text can be extended through Python plugins. Plugins build features by reusing existing commands or creating new ones. Plugins are a logical entity, rather than a physical one.</p><h2 id="prerequisites" tabindex="-1">Prerequisites <a class="header-anchor" href="#prerequisites" aria-label="Permalink to &quot;Prerequisites&quot;">​</a></h2><p>In order to write plugins, you must be able to program in <a href="https://www.python.org" target="_blank" rel="noreferrer">Python</a>. At the time of this writing, Sublime Text uses Python 3.3.</p><h2 id="where-to-store-plugins" tabindex="-1">Where to Store Plugins <a class="header-anchor" href="#where-to-store-plugins" aria-label="Permalink to &quot;Where to Store Plugins&quot;">​</a></h2><p>Sublime Text will look for plugins only in these places:</p><ul><li><code>Installed Packages</code> (only <code>.sublime-package</code> files)</li><li><code>Packages</code></li><li><code>Packages/&lt;pkg_name&gt;/</code></li></ul><p>As a consequence, any plugin nested deeper in <code>Packages</code> won&#39;t be loaded.</p><p>Keeping plugins directly under <code>Packages</code> is discouraged. Sublime Text sorts packages in a predefined way before loading them, so if you save plugin files directly under <code>Packages</code> you might get confusing results.</p><h2 id="your-first-plugin" tabindex="-1">Your First Plugin <a class="header-anchor" href="#your-first-plugin" aria-label="Permalink to &quot;Your First Plugin&quot;">​</a></h2><p>Let&#39;s write a &quot;Hello, World!&quot; plugin for Sublime Text:</p><ol><li>Select <strong>Tools | Developer | New Plugin...</strong> in the menu.</li><li>Save to <code>Packages/User/hello_world.py</code>.</li></ol><p>You&#39;ve just written your first plugin! Let&#39;s put it to use:</p>',15),p=s("li",null,[e("Type: "),s("code",null,'view.run_command("example")'),e(" and press enter.")],-1),c=n(`<p>You should see the text &quot;Hello, World!&quot; in the newly created buffer.</p><h2 id="analyzing-your-first-plugin" tabindex="-1">Analyzing Your First Plugin <a class="header-anchor" href="#analyzing-your-first-plugin" aria-label="Permalink to &quot;Analyzing Your First Plugin&quot;">​</a></h2><p>The plugin created in the previous section should look roughly like this:</p><div class="language-py vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">py</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sublime</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sublime_plugin</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ExampleCommand</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sublime_plugin</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">TextCommand</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">):</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> run</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(self, edit):</span></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">        self</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.view.insert(edit, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;Hello, World!&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span></code></pre></div><p>Both the <code>sublime</code> and <code>sublime_plugin</code> modules are provided by Sublime Text; they are not part of the Python standard library.</p><p>As we mentioned earlier, plugins reuse or create <em>commands</em>. Commands are an essential building block in Sublime Text. They are simply Python classes that can be called in similar ways from different Sublime Text facilities, like the plugin API, menu files, macros, etc.</p><p>Sublime Text Commands derive from the <code>*Command</code> classes defined in <code>sublime_plugin</code> (more on this later).</p><p>The rest of the code in our example is concerned with particulars of <code>TextCommand</code> or with the API. We&#39;ll discuss those topics in later sections.</p><p>Before moving on, though, we&#39;ll look at how we invoked the new command: first we opened the Python console and then we issued a call to <code>view.run_command()</code>. This is a rather inconvenient way of calling commands, but it&#39;s often useful when you&#39;re in the development phase of a plugin. For now, keep in mind that your commands can be accessed through key bindings and by other means, just like other commands.</p><h3 id="conventions-for-command-names" tabindex="-1">Conventions for Command Names <a class="header-anchor" href="#conventions-for-command-names" aria-label="Permalink to &quot;Conventions for Command Names&quot;">​</a></h3><p>You may have noticed that our command is named <code>ExampleCommand</code>, but we passed the string <code>example</code> to the API call instead. This is necessary because Sublime Text standardizes command names by stripping the <code>Command</code> suffix, splitting subwords of <code>PhrasesLikeThis</code> with underscores, and lower-casing it, like so: <code>phrases_like_this</code>.</p><p>New commands should follow the same naming pattern.</p><h2 id="types-of-commands" tabindex="-1">Types of Commands <a class="header-anchor" href="#types-of-commands" aria-label="Permalink to &quot;Types of Commands&quot;">​</a></h2><p>You can create the following types of commands:</p><ul><li>Window commands (<code>sublime_plugin.WindowCommand</code>)</li><li>Text commands (<code>sublime_plugin.TextCommand</code>)</li></ul><p>When writing plugins, consider your goal and choose the appropriate type of commands.</p><h3 id="shared-traits-of-commands" tabindex="-1">Shared Traits of Commands <a class="header-anchor" href="#shared-traits-of-commands" aria-label="Permalink to &quot;Shared Traits of Commands&quot;">​</a></h3><p>All commands need to implement a <code>.run()</code> method in order to work. Additionally, they can receive an arbitrarily long number of keyword parameters.</p><p><strong>Note:</strong> Parameters to commands must be valid JSON values due to how ST serializes them internally.</p><h3 id="window-commands" tabindex="-1">Window Commands <a class="header-anchor" href="#window-commands" aria-label="Permalink to &quot;Window Commands&quot;">​</a></h3><p>Window commands operate at the window level. This doesn&#39;t mean that you can&#39;t manipulate views from window commands, but rather that you don&#39;t need views in order for window commands to be available. For instance, the built-in command <code>new_file</code> is defined as a <code>WindowCommand</code> so it works even when no view is open. Requiring a view to exist in that case wouldn&#39;t make sense.</p><p>Window command instances have a <code>.window</code> attribute to point to the window instance that created them.</p><p>The <code>.run()</code> method of a window command doesn&#39;t require any positional parameter.</p><p>Window commands are able to route text commands to their window&#39;s active view.</p><h3 id="text-commands" tabindex="-1">Text Commands <a class="header-anchor" href="#text-commands" aria-label="Permalink to &quot;Text Commands&quot;">​</a></h3><p>Text commands operate at the view level, so they require a view to exist in order to be available.</p><p>Text command instances have a <code>.view</code> attribute pointing to the view instance that created them.</p><p>The <code>.run()</code> method of text commands requires an <code>edit</code> instance as its first positional argument.</p><h4 id="text-commands-and-the-edit-object" tabindex="-1">Text Commands and the <code>edit</code> Object <a class="header-anchor" href="#text-commands-and-the-edit-object" aria-label="Permalink to &quot;Text Commands and the \`edit\` Object&quot;">​</a></h4><p>The edit object groups modifications to the view so that undo and macros work sensibly.</p><p><strong>Note:</strong> Contrary to older versions, Sublime Text 3 doesn&#39;t allow programmatic control over edit objects. The API is in charge of managing their life cycle. Plugin creators must ensure that all modifying operations occur inside the <code>.run</code> method of new text commands. To call existing commands, you can use <code>view.run_command(&lt;cmd_name&gt;, &lt;args&gt;)</code> or similar API calls.</p><h3 id="responding-to-events" tabindex="-1">Responding to Events <a class="header-anchor" href="#responding-to-events" aria-label="Permalink to &quot;Responding to Events&quot;">​</a></h3><p>Any command deriving from <code>EventListener</code> will be able to respond to events.</p><h3 id="another-plugin-example-feeding-the-completions-list" tabindex="-1">Another Plugin Example: Feeding the Completions List <a class="header-anchor" href="#another-plugin-example-feeding-the-completions-list" aria-label="Permalink to &quot;Another Plugin Example: Feeding the Completions List&quot;">​</a></h3><p>Let&#39;s create a plugin that fetches data from Google&#39;s Autocomplete service and then feeds it to the Sublime Text completions list. Please note that, as ideas for plugins go, this a very bad one.</p><div class="language-python vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">python</span><pre class="shiki shiki-themes github-light github-dark vp-code"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sublime</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sublime_plugin</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">from</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> xml.etree </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> ElementTree </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">as</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ET</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> urllib</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">GOOGLE_AC</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;http://google.com/complete/search?output=toolbar&amp;q=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">%s</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">class</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> GoogleAutocomplete</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">sublime_plugin</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">EventListener</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">):</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">    def</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> on_query_completions</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(self, view, prefix, locations):</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        elements </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ET</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.parse(</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">            urllib.request.urlopen(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">GOOGLE_AC</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> %</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> prefix)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        ).getroot().findall(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;./CompleteSuggestion/suggestion&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">        sugs </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> [(x.attrib[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;data&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">],) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 2</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> x </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">in</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> elements]</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">        return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> sugs</span></span></code></pre></div><div class="tip custom-block"><p class="custom-block-title">Note</p><p>Make sure you don&#39;t keep this plugin around after trying it or it will interfere with the autocompletion system.</p></div><h2 id="learning-the-api" tabindex="-1">Learning the API <a class="header-anchor" href="#learning-the-api" aria-label="Permalink to &quot;Learning the API&quot;">​</a></h2><p>The API reference is documented at <a href="https://www.sublimetext.com/docs/api_reference.html" target="_blank" rel="noreferrer">https://www.sublimetext.com/docs/api_reference.html</a>.</p><p>To get acquainted with the Sublime Text API and the available commands, it may be helpful to read existing code and learn from it.</p><p>In particular, the <code>Packages/Default</code> contains many examples of undocumented commands and API calls. Note that you will first have to extract its contents to a folder if you want to take a look at the code within. The <em>View Package File</em> command in the Command Palette helps with this.</p>`,41);function m(u,k,g,y,E,f){const i=o("Key");return r(),l("div",null,[d,s("ol",null,[s("li",null,[e("Create a new buffer ("),a(i,{k:"ctrl+n"}),e(").")]),s("li",null,[e("Open the Python console ("),a(i,{k:"ctrl+`"}),e(").")]),p]),c])}const x=t(h,[["render",m]]);export{w as __pageData,x as default};
